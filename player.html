<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Player de Vídeo HLS</title>
  
  <!-- Carrega a biblioteca HLS que estará na mesma pasta no servidor do Render -->
  <script src="hls.min.js"></script>
  
  <style>
    /* Estilo para fazer o player ocupar 100% do espaço disponível, sem margens ou bordas */
    html, body { 
      margin: 0; 
      padding: 0; 
      background: #000; /* Fundo preto para uma aparência profissional */
      height: 100%; 
      overflow: hidden; /* Esconde barras de rolagem desnecessárias */
    }
    video { 
      width: 100%; 
      height: 100%; 
      border: none; 
    }
  </style>
</head>
<body>

  <!-- O elemento <video> que será controlado pelo HLS.js. 
       'controls' - mostra os controles de play/pause/volume.
       'autoplay' - tenta iniciar o vídeo automaticamente (pode ser bloqueado por navegadores).
       'playsinline' - essencial para o autoplay funcionar em iPhones. -->
  <video id="video" controls autoplay playsinline></video>

  <script>
    // Pega os parâmetros da URL da página (a parte que vem depois do '?').
    const params = new URLSearchParams(window.location.search);
    
    // Busca o valor do parâmetro que chamamos de 'Blogger'.
    // Este parâmetro conterá a URL do vídeo que queremos tocar.
    const token = params.get('Blogger');

    // Verifica se o parâmetro 'Blogger' foi realmente fornecido na URL.
    if (token) {
      // Monta a URL para o nosso proxy, que está na mesma pasta no servidor.
      // O 'encodeURIComponent' garante que a URL do vídeo seja passada corretamente, mesmo com caracteres especiais.
      const proxyUrl = `proxy.php?url=${encodeURIComponent(token)}`;
      
      // Pega o elemento <video> da página para podermos manipulá-lo.
      const video = document.getElementById('video');

      // Verifica se o navegador do usuário suporta a biblioteca HLS.js (quase todos, exceto Safari antigo).
      if (Hls.isSupported()) {
        const hls = new Hls();
        // Carrega a fonte do vídeo através do nosso script de proxy.
        hls.loadSource(proxyUrl);
        // "Anexa" o stream de vídeo ao nosso elemento <video> para que ele seja exibido.
        hls.attachMedia(video);
      } 
      // Se for Safari ou um dispositivo Apple, que tem suporte nativo a HLS, usamos a abordagem direta.
      else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = proxyUrl;
      }
    } else {
      // Se o parâmetro 'Blogger' não foi encontrado na URL, exibe uma mensagem de erro clara.
      document.body.innerHTML = "<p style='color:white; text-align:center; font-family: sans-serif;'>ERRO: URL do vídeo não foi fornecida.</p>";
    }
  </script>
</body>
</html>
